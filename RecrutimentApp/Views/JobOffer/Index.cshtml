@model IEnumerable<JobOffer>

<div class="row page-box">
    <div class="col-sm-12">
        <h2>Job Offers list</h2>

        <div class="input-group col-md-12" style="margin-bottom: 14px">
            <input type="text" class="form-control" placeholder="Search offer by title..."
                   name="search" id="search" />
            <span class="input-group-btn">
                <button class="btn btn-info" onclick="find();" id="searchButton">
                    <i class="glyphicon glyphicon-search"></i>
                </button>
            </span>
        </div>

        <table class="table table-striped table-hover">
            <thead class="thead-dark">
                <tr>
                    <th scope="col">Job Title</th>
                    <th scope="col">Company</th>
                    <th scope="col">Location</th>
                    <th scope="col">Created</th>
                </tr>
            </thead>
            <tbody id="records_table" />
        </table>

        @Html.ActionLink("Create job offer", "Create", "JobOffer", null, new { id = "createJobOffer", @class = "btn btn-primary" })
    </div>
</div>

@section Scripts {
    <script>
        var uri = '/api/SampleApi/GetJobOffers';

        $(document).ready(find);

        function find() {
            var uriToRequest = uri;
            var searchString = $('#search').val();
            if (searchString != "")
                uriToRequest = uri + "/" + searchString;
            $.getJSON(uriToRequest)
                .done(function (data) {
                    var c = [];
                    $.each(data, function (_key, item) {
                        c.push("<tr><td><a href=\"JobOffer/Details?id=" + item.id + "\">" + item.jobTitle + "<a></td>");
                        c.push("<td>" + item.company.name + "</td>");
                        c.push("<td>" + item.location + "</td>");
                        c.push("<td>" + new Date(item.created).toUTCString() + "</td></tr>");
                    });
                    $('#records_table').html(c.join(""))
                });
        }
    </script>
}